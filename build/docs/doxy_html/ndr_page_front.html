<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: Ndr : Node Definition Registry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ndr_page_front.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Ndr : Node Definition Registry </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ndr_Organization">Ndr Organization</a><ul><li class="level2"><a href="#ndr_BaseClass">Ndr Base Registry</a></li>
<li class="level2"><a href="#ndr_BaseNode">Ndr Base Node</a></li>
<li class="level2"><a href="#ndr_BaseProperty">Ndr Base Property</a></li>
<li class="level2"><a href="#ndr_DiscoveryPlugin">Discovery Plugins</a></li>
<li class="level2"><a href="#ndr_ParserPlugin">Parser Plugins</a></li>
</ul>
</li>
<li class="level1"><a href="#custom_setup">How to Set Up a Domain-Specific Registry</a><ul><li class="level2"><a href="#ndr_customReg">Custom Registry</a></li>
<li class="level2"><a href="#ndr_customNode">Custom Nodes</a></li>
</ul>
</li>
<li class="level1"><a href="#ndr_customProperty">Custom Properties</a></li>
<li class="level1"><a href="#ndr_customDiscovery">Custom Discovery Plugin</a></li>
<li class="level1"><a href="#ndr_customParser">Custom Parser Plugin</a></li>
</ul>
</div>
<div class="textblock"><p>Ndr provides a framework in which you can, agnostic to the node's domain (shading, lighting, compositing, etc), register nodes with Ndr, and subsequently ask for information about those nodes. The information Ndr provides about these nodes will be fairly generic, given that Ndr must not cater to any specific type of node. However, specialized registries can derive from Ndr, and it is there that domain-specific logic can be implemented. Additionally, node parsing and "discovery" are done via plugins, again to keep Ndr generic and extendable.</p>
<p>In addition to being able to instantiate specialized registries, domain-specific nodes and properties deriving from the base Ndr classes can also be created. This is explained in the sections below.</p>
<h1><a class="anchor" id="ndr_Organization"></a>
Ndr Organization</h1>
<p>Ndr can be split into 5 major components, as described by the following subsections.</p>
<h2><a class="anchor" id="ndr_BaseClass"></a>
Ndr Base Registry</h2>
<p>The core Ndr registry, <code><a class="el" href="class_ndr_registry.html" title="The registry provides access to node information.">NdrRegistry</a></code>, is where node-level queries are done. In practice, it will not be used directly (in almost all cases, a specialized registry deriving from Ndr core will be used instead). Upon initialization, the registry searches for all parser and discovery plugins. During this start-up phase the discovery plugins are all run, but the nodes that are found are NOT parsed. The registry parses nodes on demand when information about a node(s) is requested in order to keep the start-up process as fast as possible.</p>
<p>The type of information that the base Ndr registry provides includes: </p><ul>
<li>
The names of nodes that have been registered </li>
<li>
Parsed node instances (created on-demand when requested) </li>
<li>
Where the nodes were found </li>
</ul>
<h2><a class="anchor" id="ndr_BaseNode"></a>
Ndr Base Node</h2>
<p>Ndr provides a base node class, <code><a class="el" href="class_ndr_node.html" title="Represents an abstract node.">NdrNode</a></code>, which exposes domain-agnostic information such as:</p>
<ul>
<li>
The node type </li>
<li>
What the inputs and outputs are </li>
<li>
Any metadata attached to the node </li>
</ul>
<p>An <a class="el" href="class_ndr_node.html" title="Represents an abstract node.">NdrNode</a> represents a dataflow-connectable computation, intended to be a node in a computational network. A node's <a class="el" href="class_ndr_property.html" title="Represents a property (input or output) that is part of a NdrNode instance.">NdrProperty</a>'s represent its computational inputs and outputs, and its <b>URI</b>'s identify its external sources:</p><ul>
<li><a class="el" href="class_ndr_node.html#aabf19757b3cebfbd39863d025fcf3124" title="Gets the URI to the resource that provided this node&#39;s definition.">NdrNode::GetResolvedDefinitionURI()</a> identifies the asset that provided the definition of the node, which is determined during <a class="el" href="ndr_page_front.html#ndr_DiscoveryPlugin">node discovery.</a></li>
<li><a class="el" href="class_ndr_node.html#ae26cea86218de93b2054ab2edfed402a" title="Gets the URI to the resource that provides this node&#39;s implementation.">NdrNode::GetResolvedImplementationURI()</a> identifies (if relevant) an implementation of the node's computation, for use by clients of computational networks in which node instances may appear. It is the responsibility of a <a class="el" href="ndr_page_front.html#ndr_ParserPlugin">parser plugin</a> to determine and resolve an implementation from the node's definition.</li>
</ul>
<h2><a class="anchor" id="ndr_BaseProperty"></a>
Ndr Base Property</h2>
<p>Ndr also provides a base property class, <code><a class="el" href="class_ndr_property.html" title="Represents a property (input or output) that is part of a NdrNode instance.">NdrProperty</a></code>. Inputs and outputs are on a node are collectively identified as "properties".</p>
<p>The base property exposes information like: </p><ul>
<li>
The input type </li>
<li>
The default value, if any </li>
<li>
Any metadata attached to the property </li>
<li>
Whether the property is connectable </li>
</ul>
<h2><a class="anchor" id="ndr_DiscoveryPlugin"></a>
Discovery Plugins</h2>
<p>Discovery plugins are how the registry finds (or "discovers") nodes. The registry makes no assumptions on where, or how, nodes are stored. A discovery plugin can be built to find file-based nodes on the filesystem (a typical case), search a database, a cloud service, or any other system that might contain nodes. If nodes are scattered across multiple systems, a discovery plugin can be created for each. More info about discovery plugins is available in the <code><a class="el" href="class_ndr_discovery_plugin.html" title="Interface for discovery plugins.">NdrDiscoveryPlugin</a></code> documentation.</p>
<p>Note that a filesystem-based discovery plugin is active by default. More information on how to configure this plugin can be found in the documentation for <code><a class="el" href="class___ndr_filesystem_discovery_plugin.html" title="Discovers nodes on the filesystem.">_NdrFilesystemDiscoveryPlugin</a></code>. In a nutshell, there are a few environment variables that can be configured to control its behavior. However, the more robust pattern that any renderer or shading-system plugin should follow is to provide its <b>own</b> DiscoveryPlugin, so that its configuration will not interfere with that of other plugins. The filesystem discovery machinery that the builtin <code><a class="el" href="class___ndr_filesystem_discovery_plugin.html" title="Discovers nodes on the filesystem.">_NdrFilesystemDiscoveryPlugin</a></code> plugin uses is available for other discovery plugins to use - see <a class="el" href="filesystem_discovery_helpers_8h.html#a235c530023a4e18615c54baffb809bd2" title="Returns a vector of discovery results that have been found while walking the given search paths.">NdrFsHelpersDiscoverNodes()</a>.</p>
<h2><a class="anchor" id="ndr_ParserPlugin"></a>
Parser Plugins</h2>
<p>Once the registry knows about nodes via the discovery plugin(s), the parser plugins parse the nodes and provide the registry with the resulting information. The parser plugins are responsible for information such as the node's type, its metadata, and all information about its inputs and outputs. In the end, the parser plugin is responsible for determining all information about the node that could not otherwise be determined via the discovery plugin. More information about parser plugins is available in the <code><a class="el" href="class_ndr_parser_plugin.html" title="Interface for parser plugins.">NdrParserPlugin</a></code> documentation.</p>
<h1><a class="anchor" id="custom_setup"></a>
How to Set Up a Domain-Specific Registry</h1>
<p>The base Ndr registry can be used as-is if only generic information about nodes is needed. In most cases however, more detailed information about the nodes will be necessary, and this is where domain-specific registries come into play. The process can be divided into 5 areas of customization, which echo the 5 sections above.</p>
<h2><a class="anchor" id="ndr_customReg"></a>
Custom Registry</h2>
<p>The base Ndr registry can be derived from to create a specialized registry. In many cases, not much will be needed here except doing dynamic casts to your domain-specific nodes. The registry's base class provides methods such as <code>NdrRegistry::GetNode()</code> (which returns a <code><a class="el" href="class_ndr_node.html" title="Represents an abstract node.">NdrNode</a></code>), but you may want to provide additional methods like <code>GetShadingNode()</code> which dynamic casts the result from <code>NdrRegistry::GetNode()</code> to a shading node instance. See <code><a class="el" href="class_sdr_registry.html" title="The shading-specialized version of NdrRegistry.">SdrRegistry</a></code> for an example.</p>
<h2><a class="anchor" id="ndr_customNode"></a>
Custom Nodes</h2>
<p>As mentioned before, the base node class <code><a class="el" href="class_ndr_node.html" title="Represents an abstract node.">NdrNode</a></code> only provides generic information about the node. Specialized nodes can derive from <code><a class="el" href="class_ndr_node.html" title="Represents an abstract node.">NdrNode</a></code> to implement any additional functionality that is needed. The parser plugin for the node can provide this information to the node via the constructor. Nodes should be immutable once created. See <code><a class="el" href="class_sdr_shader_node.html" title="A specialized version of NdrNode which holds shading information.">SdrShaderNode</a></code> for an example.</p>
<h1><a class="anchor" id="ndr_customProperty"></a>
Custom Properties</h1>
<p>The process here is the same as for nodes: derive from <code><a class="el" href="class_ndr_property.html" title="Represents a property (input or output) that is part of a NdrNode instance.">NdrProperty</a></code> and add new functionality, or override existing methods. See <code><a class="el" href="class_sdr_shader_property.html" title="A specialized version of NdrProperty which holds shading information.">SdrShaderProperty</a></code> for an example.</p>
<h1><a class="anchor" id="ndr_customDiscovery"></a>
Custom Discovery Plugin</h1>
<p>See the documentation for <code><a class="el" href="class_ndr_discovery_plugin.html" title="Interface for discovery plugins.">NdrDiscoveryPlugin</a></code> for more information.</p>
<h1><a class="anchor" id="ndr_customParser"></a>
Custom Parser Plugin</h1>
<p>See the documentation for <code><a class="el" href="class_ndr_parser_plugin.html" title="Interface for parser plugins.">NdrParserPlugin</a></code> for more information. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:57 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>