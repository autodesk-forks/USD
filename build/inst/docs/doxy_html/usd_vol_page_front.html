<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: UsdVol : USD Volume Schema</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('usd_vol_page_front.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">UsdVol : USD Volume Schema </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#usdVol_overview">Overview</a></li>
<li class="level1"><a href="#usdVol_schemas">Volume Schemas</a><ul><li class="level2"><a href="#Volume">Volume</a></li>
<li class="level2"><a href="#FieldBase">FieldBase</a></li>
<li class="level2"><a href="#FieldAsset">FieldAsset</a></li>
<li class="level2"><a href="#OpenVDBAsset">OpenVDBAsset</a></li>
<li class="level2"><a href="#Field3DAsset">Field3DAsset</a></li>
</ul>
</li>
<li class="level1"><a href="#usdVol_example">Example Usage</a></li>
<li class="level1"><a href="#usdVol_usage">Usage Notes</a><ul><li class="level2"><a href="#usdVol_namespace_org">Namespace Organization and Transformation</a></li>
<li class="level2"><a href="#usdVol_fieldNaming">Field Relationships Establish Consumer Field Names</a></li>
<li class="level2"><a href="#usdVol_noFileFormat">Why is OpenVDBAsset not a FileFormat plugin?</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="usdVol_overview"></a>
Overview</h1>
<p>UsdVol provides schemas for representing volumes (smoke, fire, etc). UsdVol can be used directly for representing OpenVDB and Field3d assets, or extended to support other volume formats.</p>
<h1><a class="anchor" id="usdVol_schemas"></a>
Volume Schemas</h1>
<h2><a class="anchor" id="Volume"></a>
Volume</h2>
<p><a class="el" href="class_usd_vol_volume.html" title="A renderable volume primitive.">UsdVolVolume</a> schema describes a volume composed of multiple fields. A field is a "grid" in OpenVDB terminology. Volume is a <a class="el" href="class_usd_geom_gprim.html" title="Base class for all geometric primitives.">UsdGeomGprim</a>, so it is transformable, renderable, can have a material binding, etc.</p>
<p>A Volume has one or more named relationships to FieldBase prims.</p>
<h2><a class="anchor" id="FieldBase"></a>
FieldBase</h2>
<p><a class="el" href="class_usd_vol_field_base.html" title="Base class for field primitives.">UsdVolFieldBase</a> is an abstract schema representing a single volume field. This schema should be inherited by any schema representing a volume field.</p>
<h2><a class="anchor" id="FieldAsset"></a>
FieldAsset</h2>
<p><a class="el" href="class_usd_vol_field_asset.html" title="Base class for field primitives defined by an external file.">UsdVolFieldAsset</a> inherits from FieldBase and is an abstract schema representing a <b>single volume field</b> that is stored as an asset separately from the layer or stage. USD does not currently support data types required to represent volumetric data directly, so volumes are generally stored using purpose-built file formats such as OpenVDB. This schema should be inherited by any schema representing a volume field stored as an asset outside of USD.</p>
<p>As field asset formats may store multiple fields in a single asset, <a class="el" href="class_usd_vol_field_asset.html" title="Base class for field primitives defined by an external file.">UsdVolFieldAsset</a> contains properties <b>fieldName</b> and <b>fieldIndex</b> to aid in selecting the single desired field.</p>
<h2><a class="anchor" id="OpenVDBAsset"></a>
OpenVDBAsset</h2>
<p><a class="el" href="class_usd_vol_open_v_d_b_asset.html" title="OpenVDB field primitive.">UsdVolOpenVDBAsset</a> inherits from FieldAsset and is a concrete schema representing a single volume field stored as an OpenVDB asset.</p>
<p>Learn about OpenVDB at <a href="https://www.openvdb.org/">https://www.openvdb.org/</a>.</p>
<h2><a class="anchor" id="Field3DAsset"></a>
Field3DAsset</h2>
<p><a class="el" href="class_usd_vol_field3_d_asset.html" title="Field3D field primitive.">UsdVolField3DAsset</a> inherits from FieldAsset and is a concrete schema representing a single volume field stored as a Field3D asset.</p>
<p>Learn about Field3D at <a href="https://sites.google.com/site/field3d/">https://sites.google.com/site/field3d/</a></p>
<h1><a class="anchor" id="usdVol_example"></a>
Example Usage</h1>
<p>Here is a simple example of a Volume prim, representing a static wisp of smoke: </p><pre class="fragment">def Volume "wisp"
{
    float3[] extent = [(-57, -91, -44), (57, 31, -23)]

    rel field:density = &lt;/wisp/density&gt;

    def OpenVDBAsset "density"
    {
        asset filePath = @./wisp_01.vdb@
        token fieldName = "density"
    }
}
</pre><p>Volumes are generally not static. For volumes with OpenVDBAsset fields, volume animation is represented by setting time samples on the filePath attribute: </p><pre class="fragment">def Volume "wisp"
{
    float3[] extent = [(-57, -91, -44), (57, 31, -23)]

    rel field:density = &lt;/wisp/density&gt;

    def OpenVDBAsset "density"
    {
        asset filePath.timeSamples = {
            101: @./wisp_01.101.vdb@,
            102: @./wisp_01.102.vdb@,
            103: @./wisp_01.103.vdb@,
            104: @./wisp_01.104.vdb@,
        }
        token fieldName = "density"
    }
}
</pre><h1><a class="anchor" id="usdVol_usage"></a>
Usage Notes</h1>
<h2><a class="anchor" id="usdVol_namespace_org"></a>
Namespace Organization and Transformation</h2>
<p><a class="el" href="class_usd_vol_field_asset.html" title="Base class for field primitives defined by an external file.">UsdVolFieldAsset</a> describes a single field that can be loaded from an external asset. FieldAsset has a <b>filePath</b> attribute that specifies an asset path where a volume file can be found.</p>
<p>Field prims are not required to be children of the Volume prim. But in most cases the Volume and its Fields are conceptually inseparable, so Field prims are generally created as children of the Volume prim for organization purposes, ease of referencing, and overall ease of use.</p>
<p>Relatedy, the grid extracted from a Field prim is positioned in world space by <b>the local-to-world transformation of the Field prim</b>, plus any transformation contained in a FieldAsset's external asset encoding. This semantic makes clear why organizing Fields under a Volume is useful: re-positioning the Volume prim will automatically move all its child Field prims along with it.</p>
<h2><a class="anchor" id="usdVol_fieldNaming"></a>
Field Relationships Establish Consumer Field Names</h2>
<p>The Volume prim must establish named relationships to its Fields using the <a class="el" href="class_usd_vol_volume.html#afd1fbbcfa5e57c715b4a75f4073f6522" title="Creates a relationship on this volume that targets the specified field.">UsdVolVolume::CreateFieldRelationship()</a> method. This is how the "field:density" relationship is created on the Volume prim in the examples above.</p>
<p>The naming of the field relationship on the Volume prim and setting a fieldName on the OpenVDBAsset may seem redundant, but it is not. The intention is to allow a Volume to define fields by the names appropriate for the Volume and/or pipeline, without tying these to the VDB grid name. For example, a Volume might want a "velocity" field for the purposes of shader parameters, but you have a VDB with a grid named "vel". Defining field:velocity on the Volume prim would accomplish that. You can also re-use Fields for multiple volume fields in this way.</p>
<h2><a class="anchor" id="usdVol_noFileFormat"></a>
Why is OpenVDBAsset not a FileFormat plugin?</h2>
<p>USD does not have a way to describe volumetric data structures. This is similar to how textures are not FileFormat plugins either - USD does not have data structures to represent image data. In both cases, It can be argued that USD <em>should not</em> do this. A VDB can be thought of as a 3D texture for this purpose, so the OpenVDBAsset schema describes an asset path where it can be discovered for someone else (Hydra, your renderer, etc) to interpret. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:57 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>