<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: pxr/base/tf/singleton.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('singleton_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">singleton.h File Reference<div class="ingroups"><a class="el" href="group__group__tf___object_creation.html">Object Creation</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage a single instance of an object.  
<a href="#details">More...</a></p>
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for singleton.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="singleton_8h__incl.png" border="0" usemap="#pxr_2base_2tf_2singleton_8h" alt=""/></div>
<map name="pxr_2base_2tf_2singleton_8h" id="pxr_2base_2tf_2singleton_8h">
<area shape="rect"  title="Manage a single instance of an object." alt="" coords="115,5,283,32"/>
<area shape="rect"  href="pxr_8h.html" title=" " alt="" coords="5,80,83,107"/>
<area shape="rect"  href="pragmas_8h.html" title="Pragmas for controlling compiler&#45;specific behaviors." alt="" coords="107,80,289,107"/>
<area shape="rect"  title=" " alt="" coords="315,80,381,107"/>
<area shape="rect"  href="defines_8h_source.html" title=" " alt="" coords="112,155,285,181"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="singleton_8h__dep__incl.png" border="0" usemap="#pxr_2base_2tf_2singleton_8hdep" alt=""/></div>
<map name="pxr_2base_2tf_2singleton_8hdep" id="pxr_2base_2tf_2singleton_8hdep">
<area shape="rect"  title="Manage a single instance of an object." alt="" coords="2800,5,2968,32"/>
<area shape="rect"  href="base_2plug_2registry_8h_source.html" title=" " alt="" coords="465,88,639,115"/>
<area shape="rect"  href="diagnostic_mgr_8h.html" title=" " alt="" coords="1287,88,1485,115"/>
<area shape="rect"  href="instantiate_singleton_8h.html" title="Manage a single instance of an object." alt="" coords="1510,88,1748,115"/>
<area shape="rect"  href="py_enum_8h.html" title="Provide facilities for wrapping enums for script." alt="" coords="1773,88,1933,115"/>
<area shape="rect"  href="py_singleton_8h_source.html" title=" " alt="" coords="1958,88,2143,115"/>
<area shape="rect"  href="py_wrap_context_8h_source.html" title=" " alt="" coords="2168,88,2376,115"/>
<area shape="rect"  href="ref_ptr_tracker_8h.html" title=" " alt="" coords="2401,88,2591,115"/>
<area shape="rect"  href="reg_test_8h.html" title="Support for simple regression tests." alt="" coords="2616,88,2771,115"/>
<area shape="rect"  href="script_module_loader_8h_source.html" title=" " alt="" coords="2795,81,2973,122"/>
<area shape="rect"  href="category_8h.html" title=" " alt="" coords="3524,88,3711,115"/>
<area shape="rect"  href="collector_8h_source.html" title=" " alt="" coords="3440,269,3627,296"/>
<area shape="rect"  href="value_from_python_8h.html" title=" " alt="" coords="3785,88,4009,115"/>
<area shape="rect"  href="usd_2kind_2registry_8h.html" title=" " alt="" coords="4034,88,4200,115"/>
<area shape="rect"  href="usd_2sdf_2schema_8h_source.html" title=" " alt="" coords="3049,88,3209,115"/>
<area shape="rect"  href="usd_2sdr_2registry_8h.html" title=" " alt="" coords="4225,88,4383,115"/>
<area shape="rect"  href="schema_registry_8h_source.html" title=" " alt="" coords="3234,88,3448,115"/>
<area shape="rect"  href="context_caps_8h_source.html" title=" " alt="" coords="4408,88,4627,115"/>
<area shape="rect"  href="filtering_scene_index_8h_source.html" title=" " alt="" coords="1174,171,1348,213"/>
<area shape="rect"  href="hd_2perf_log_8h_source.html" title=" " alt="" coords="3367,427,3552,453"/>
<area shape="rect"  href="renderer_plugin_registry_8h_source.html" title=" " alt="" coords="5,262,224,303"/>
<area shape="rect"  href="resource_registry_8h_source.html" title=" " alt="" coords="2759,501,3001,528"/>
<area shape="rect"  href="scene_index_8h_source.html" title=" " alt="" coords="888,88,1099,115"/>
<area shape="rect"  href="scene_index_plugin_registry_8h_source.html" title=" " alt="" coords="249,262,447,303"/>
<area shape="rect"  href="config_8h_source.html" title=" " alt="" coords="4651,81,4821,122"/>
<area shape="rect"  href="generative_procedural_plugin_registry_8h_source.html" title=" " alt="" coords="471,262,683,303"/>
<area shape="rect"  href="image_registry_8h_source.html" title=" " alt="" coords="4845,88,5077,115"/>
<area shape="rect"  href="adapter_registry_8h.html" title=" " alt="" coords="5101,81,5304,122"/>
<area shape="rect"  href="this_plugin_8h_source.html" title=" " alt="" coords="225,179,415,205"/>
<area shape="rect"  href="plugin_registry_8h_source.html" title=" " alt="" coords="440,179,664,205"/>
<area shape="rect"  href="error_mark_8h.html" title=" " alt="" coords="2093,269,2264,296"/>
<area shape="rect"  href="error_transport_8h.html" title=" " alt="" coords="1425,179,1623,205"/>
<area shape="rect"  href="coalescing_diagnostic_delegate_8h.html" title="A class which provides aggregation of warnings and statuses emitted from Tf&#39;s diagnostic management s..." alt="" coords="1648,171,1848,213"/>
<area shape="rect"  href="conditional_abort_diagnostic_delegate_8h_source.html" title=" " alt="" coords="1872,171,2075,213"/>
<area shape="rect"  href="event_8h_source.html" title=" " alt="" coords="3571,179,3739,205"/>
<area shape="rect"  href="trace_8h.html" title=" " alt="" coords="3378,352,3541,379"/>
<area shape="rect"  href="prim_8h.html" title=" " alt="" coords="3129,427,3271,453"/>
<area shape="rect"  href="accessor_helpers_8h.html" title=" " alt="" coords="2339,269,2556,296"/>
<area shape="rect"  href="children_policies_8h_source.html" title=" " alt="" coords="2606,179,2817,205"/>
<area shape="rect"  href="list_editor_8h_source.html" title=" " alt="" coords="2581,269,2747,296"/>
<area shape="rect"  href="schema_type_registration_8h_source.html" title=" " alt="" coords="2843,179,3112,205"/>
<area shape="rect"  href="sdf_2spec_8h.html" title=" " alt="" coords="2390,179,2529,205"/>
<area shape="rect"  href="prim_definition_8h_source.html" title=" " alt="" coords="3238,179,3444,205"/>
<area shape="rect"  href="stage_8h.html" title=" " alt="" coords="3267,269,3416,296"/>
<area shape="rect"  href="dependency_forwarding_scene_index_8h_source.html" title=" " alt="" coords="708,262,911,303"/>
<area shape="rect"  href="flattening_scene_index_8h_source.html" title=" " alt="" coords="935,262,1121,303"/>
<area shape="rect"  href="material_filtering_scene_index_base_8h_source.html" title=" " alt="" coords="1146,262,1376,303"/>
<area shape="rect"  href="merging_scene_index_8h_source.html" title=" " alt="" coords="1401,262,1617,303"/>
<area shape="rect"  href="notice_batching_scene_index_8h_source.html" title=" " alt="" coords="1643,262,1864,303"/>
<area shape="rect"  href="prefixing_scene_index_8h_source.html" title=" " alt="" coords="1888,262,2069,303"/>
</map>
</div>
</div>
<p><a href="singleton_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tf_singleton.html">TfSingleton&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage a single instance of an object (see.  <a href="class_tf_singleton.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage a single instance of an object. </p>
<p>Many classes (for example, registries) should have only a single, globally available instance that is created as needed on demand. This is a classic design pattern known as a <em>singleton</em>. Additionally, creation of this class (though not access to it per se) must be made threadsafe.</p>
<p>There are two possibilities in creating a singleton: you can create a class all of whose member functions and variables are static, and let users access this class. Unfortunately, instantiating the static variables of this class is prone to difficulty; more importantly, should you change your mind and wish to allow multiple instances of the class, much rewriting follows.</p>
<p>A better solution is to define the class with regular members and variables, and then permit only a single instance of the class to exist. This is the philosophy embodied by the <code><a class="el" href="class_tf_singleton.html" title="Manage a single instance of an object (see.">TfSingleton</a></code> template. It takes care of both multithreaded initialization and initialization before main; the cost of this is quite low (a single boolean comparison to access the instanced object after initial creation). The <code><a class="el" href="class_tf_singleton.html" title="Manage a single instance of an object (see.">TfSingleton</a></code> template works in conjunction with a macro in the source file <a class="el" href="instantiate_singleton_8h.html#a44dda10fb9f9ec22b1a8a92f7466c3e4" title="Source file definition that a type is being used as a singleton.">TF_INSTANTIATE_SINGLETON()</a>, which is itself defined by including the file "pxr/base/tf/instantiateSingleton.h".</p>
<p><a class="anchor" id="TfSingleton_typicalUse"></a><b> Typical Use </b></p>
<p>The typical use of <code><a class="el" href="class_tf_singleton.html" title="Manage a single instance of an object (see.">TfSingleton</a></code> is as follows: </p><div class="fragment"><div class="line"><span class="comment">// file: registry.h</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="singleton_8h.html">pxr/base/tf/singleton.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Registry {</div><div class="line">    Registry(<span class="keyword">const</span> Registry&amp;) = <span class="keyword">delete</span>;</div><div class="line">    Registry&amp; operator=(<span class="keyword">const</span> Registry&amp;) = <span class="keyword">delete</span>;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">static</span> Registry&amp; GetInstance() {</div><div class="line">         <span class="keywordflow">return</span> <a class="code" href="class_tf_singleton.html#a0866aab4257483326c469dcef942f0e1">TfSingleton&lt;Registry&gt;::GetInstance</a>();</div><div class="line">    }</div><div class="line"></div><div class="line">    ...</div><div class="line"></div><div class="line">private:</div><div class="line">    Registry();</div><div class="line">    ~Registry();</div><div class="line"></div><div class="line">    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="class_tf_singleton.html">TfSingleton</a>&lt;Registry&gt;;</div><div class="line"> };</div><div class="line"></div><div class="line"><span class="comment">// file: Registry.cpp</span></div><div class="line"><span class="preprocessor">#include &quot;common/astrology/registry.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="instantiate_singleton_8h.html">pxr/base/tf/instantiateSingleton.h</a>&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="instantiate_singleton_8h.html#a44dda10fb9f9ec22b1a8a92f7466c3e4">TF_INSTANTIATE_SINGLETON</a>(Registry);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// file: RandomCode.cpp</span></div><div class="line"><span class="preprocessor">#include &quot;common/astrology/registry.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Code() {</div><div class="line">     Registry&amp; r = Registry::GetInstance();</div><div class="line">     r.Lookup(...);</div><div class="line">     ...</div><div class="line">}</div></div><!-- fragment --><p>The constructor and destructor are declared private, and the singleton object will typically delete its copy constructor and assignment operator to prevent copying. Note that singleton objects quite commonly also make use of <code><a class="el" href="class_tf_registry_manager.html" title="Manage initialization of registries.">TfRegistryManager</a></code> to acquire the data they need throughout a program.</p>
<p>The friend class <code>TfSingleton&lt;Registry&gt;</code> is the only class allowed to create an instance of a Registry. The helper function <code>Registry::GetInstance()</code> is for convenience only; one can just as well call the longer <code><a class="el" href="class_tf_singleton.html#a0866aab4257483326c469dcef942f0e1" title="Return a reference to an object of type T, creating it if necessary.">TfSingleton&lt;Registry&gt;::GetInstance()</a></code> to obtain a reference to the sole instance of the registry. </p>

<p class="definition">Definition in file <a class="el" href="singleton_8h_source.html">singleton.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1d43f220d4da368b75944030615bc443.html">pxr</a></li><li class="navelem"><a class="el" href="dir_682898b56c69f5cabb813635d1588cf1.html">base</a></li><li class="navelem"><a class="el" href="dir_dfcdafeb163cb945f0b6b2c9b02a7be3.html">tf</a></li><li class="navelem"><a class="el" href="singleton_8h.html">singleton.h</a></li>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:54 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>