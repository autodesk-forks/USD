<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: pxr/base/trace/collector.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('collector_8h_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">collector.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Copyright 2018 Pixar</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;Apache License&quot;)</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// with the following modification; you may not use this file except in</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// compliance with the Apache License and the following modification to it:</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Section 6. Trademarks. is deleted and replaced with:</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// 6. Trademarks. This License does not grant permission to use the trade</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//    names, trademarks, service marks, or product names of the Licensor</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//    and its affiliates, except as required to comply with Section 4(c) of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//    the License and to reproduce the content of the NOTICE file.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// You may obtain a copy of the Apache License at</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// distributed under the Apache License with the above modification is</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// KIND, either express or implied. See the Apache License for the specific</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// language governing permissions and limitations under the Apache License.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef PXR_BASE_TRACE_COLLECTOR_H</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define PXR_BASE_TRACE_COLLECTOR_H</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pxr_8h.html">pxr/pxr.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/api.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/concurrentList.h&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/collection.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/event.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/key.h&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;pxr/base/trace/threads.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="declare_ptrs_8h.html">pxr/base/tf/declarePtrs.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="malloc_tag_8h.html">pxr/base/tf/mallocTag.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;pxr/base/tf/pyTracing.h&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="singleton_8h.html">pxr/base/tf/singleton.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ref_base_8h.html">pxr/base/tf/refBase.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ref_ptr_8h.html">pxr/base/tf/refPtr.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="weak_base_8h.html">pxr/base/tf/weakBase.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="weak_ptr_8h.html">pxr/base/tf/weakPtr.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pragmas_8h.html">pxr/base/arch/pragmas.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;tbb/spin_mutex.h&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;PXR_NAMESPACE_OPEN_SCOPE</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">class </span>TraceScopeHolder;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<a class="code" href="declare_ptrs_8h.html#a5435f413811b6758dc658a6ab0932e11">TF_DECLARE_WEAK_PTRS</a>(<a class="code" href="class_trace_collector.html">TraceCollector</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<a class="code" href="declare_ptrs_8h.html#a82e60c4622cb84bba86c7ef61d37bf1f">TF_DECLARE_WEAK_AND_REF_PTRS</a>(TraceScope);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="class_trace_collector.html">   71</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_trace_collector.html">TraceCollector</a> : <span class="keyword">public</span> <a class="code" href="class_tf_weak_base.html">TfWeakBase</a> {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    TF_MALLOC_TAG_NEW(<span class="stringliteral">&quot;Trace&quot;</span>, <span class="stringliteral">&quot;TraceCollector&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">using</span> <a class="code" href="class_trace_collector.html">This</a> = <a class="code" href="class_trace_collector.html">TraceCollector</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">using</span> ThisPtr = TraceCollectorPtr;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">using</span> TimeStamp = <a class="code" href="class_trace_event.html#a166027cc433a33197d502f882979d160">TraceEvent::TimeStamp</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">using</span> <a class="code" href="class_trace_dynamic_key.html">Key</a> = <a class="code" href="class_trace_dynamic_key.html">TraceDynamicKey</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a7c6ef45a242396370e5d51e4c0ed8ec7">   84</a></span>&#160;    TRACE_API <span class="keyword">static</span> <a class="code" href="class_trace_collector.html">TraceCollector</a>&amp; <a class="code" href="class_trace_collector.html#a7c6ef45a242396370e5d51e4c0ed8ec7">GetInstance</a>() {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="class_tf_singleton.html#a0866aab4257483326c469dcef942f0e1">TfSingleton&lt;TraceCollector&gt;::GetInstance</a>();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    TRACE_API ~<a class="code" href="class_trace_collector.html">TraceCollector</a>();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    TRACE_API <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a0bd350fc68d56a8bb66c20531e7d3587">SetEnabled</a>(<span class="keywordtype">bool</span> isEnabled);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a8a49d253d7a89ed87906e2ac33c48eaa">   94</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_trace_collector.html#a8a49d253d7a89ed87906e2ac33c48eaa">IsEnabled</a>() {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> (_isEnabled.load(std::memory_order_acquire) == 1);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="struct_trace_collector_1_1_default_category.html">  100</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_trace_collector_1_1_default_category.html">DefaultCategory</a> {</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="struct_trace_collector_1_1_default_category.html#a3d2ea348b0bdf811577736f2b311057b">  102</a></span>&#160;        <span class="keyword">static</span> constexpr <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> <a class="code" href="struct_trace_collector_1_1_default_category.html#a3d2ea348b0bdf811577736f2b311057b">GetId</a>() { <span class="keywordflow">return</span> TraceCategory::Default;}</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="struct_trace_collector_1_1_default_category.html#a8a49d253d7a89ed87906e2ac33c48eaa">  104</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="struct_trace_collector_1_1_default_category.html#a8a49d253d7a89ed87906e2ac33c48eaa">IsEnabled</a>() { <span class="keywordflow">return</span> <a class="code" href="class_trace_collector.html#a8a49d253d7a89ed87906e2ac33c48eaa">TraceCollector::IsEnabled</a>(); }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    };</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#ifdef PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_trace_collector.html#a1268fce31f204097d83a3203583242cb">IsPythonTracingEnabled</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span> _isPythonTracingEnabled.load(std::memory_order_acquire) != 0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    TRACE_API <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a320516bf4af4be3d9008d85c23ecd94c">SetPythonTracingEnabled</a>(<span class="keywordtype">bool</span> enabled);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif // PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    TRACE_API TimeStamp <a class="code" href="class_trace_collector.html#ab38f463eea3fee1a8be24cde3590b34c">GetScopeOverhead</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    TRACE_API <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a91e32d7011f5bc3bd911b87e30b02ba3">Clear</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="class_trace_collector.html#abe87d69be453135038d83c3c0ec7aaa7">  136</a></span>&#160;    TimeStamp <a class="code" href="class_trace_collector.html#abe87d69be453135038d83c3c0ec7aaa7">BeginEvent</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } </div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">return</span> _BeginEvent(key, Category::GetId());</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a1132b5470b89934547dd8ea78144b9a4">  149</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a1132b5470b89934547dd8ea78144b9a4">BeginEventAtTime</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key, <span class="keywordtype">double</span> ms) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      _BeginEventAtTime(key, ms, Category::GetId());</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a434e0b198a0cdb83acf662439f19f237">  165</a></span>&#160;    TimeStamp <a class="code" href="class_trace_collector.html#a434e0b198a0cdb83acf662439f19f237">EndEvent</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">return</span> _EndEvent(key, Category::GetId());</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a1f9e33b267232faeb121ea52954782af">  178</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a1f9e33b267232faeb121ea52954782af">EndEventAtTime</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key, <span class="keywordtype">double</span> ms) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        _EndEventAtTime(key, ms, Category::GetId());</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a1a3a887bb79fceffb57ea09b53aa2802">  191</a></span>&#160;    TimeStamp <a class="code" href="class_trace_collector.html#a1a3a887bb79fceffb57ea09b53aa2802">MarkerEvent</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        } </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> _MarkerEvent(key, Category::GetId());</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a762c7dc7ed10c95e86c4eda42303e9a2">  204</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a762c7dc7ed10c95e86c4eda42303e9a2">MarkerEventAtTime</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a>&amp; key, <span class="keywordtype">double</span> ms) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled())) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      _MarkerEventAtTime(key, ms, Category::GetId());</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a409090b70e87d4d47a9a37f6e3b07aee">  217</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a409090b70e87d4d47a9a37f6e3b07aee">BeginScope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; _key) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        _BeginScope(_key, Category::GetId());</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="class_trace_collector.html#aeb08fa7315890082f202886a99206c91">  230</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#aeb08fa7315890082f202886a99206c91">BeginScope</a>(</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, Args&amp;&amp;... args) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        static_assert( <span class="keyword">sizeof</span>...(Args) %2 == 0, </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="stringliteral">&quot;Data arguments must come in pairs&quot;</span>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        threadData-&gt;BeginScope(key, Category::GetId());</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        _StoreDataRec(threadData, Category::GetId(), std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="class_trace_collector.html#ae40874970bad02a56bd51bfaff68e6b4">  248</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#ae40874970bad02a56bd51bfaff68e6b4">BeginScope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, Args&amp;&amp;... args) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        static_assert( <span class="keyword">sizeof</span>...(Args) %2 == 0, </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="stringliteral">&quot;Data arguments must come in pairs&quot;</span>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// Explicitly cast to TraceCategoryId so overload resolution choose the</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// version with a category arguement.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        BeginScope&lt;DefaultCategory&gt;(key, </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="class_trace_collector.html#adf33c1ce0c294c2c5e96109f87a73b35">  263</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#adf33c1ce0c294c2c5e96109f87a73b35">EndScope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        _EndScope(key, Category::GetId());</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    TRACE_API</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="class_trace_collector.html#a81f8d63e47276778589f4642747829d7">Scope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, TimeStamp start, TimeStamp stop) noexcept;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="class_trace_collector.html#ace377a05040cb48b00e186d64ecff1b3">  287</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#ace377a05040cb48b00e186d64ecff1b3">Scope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, TimeStamp start, TimeStamp stop) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        threadData-&gt;EmplaceEvent(</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            TraceEvent::Timespan, key, start, stop, Category::GetId());</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a85f42c728e71ba00dee09dda22a93ac7">  299</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a85f42c728e71ba00dee09dda22a93ac7">ScopeArgs</a>(Args&amp;&amp;... args) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        static_assert( <span class="keyword">sizeof</span>...(Args) %2 == 0, </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="stringliteral">&quot;Data arguments must come in pairs&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        _StoreDataRec(threadData, Category::GetId(), std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a277b6997c6804dd968251827991ad5a0">  317</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a277b6997c6804dd968251827991ad5a0">ScopeArgs</a>(Args&amp;&amp;... args) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        static_assert( <span class="keyword">sizeof</span>...(Args) %2 == 0, </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="stringliteral">&quot;Data arguments must come in pairs&quot;</span>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        ScopeArgs&lt;DefaultCategory&gt;(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="class_trace_collector.html#af6471778247e37185f213fc29ff2dfad">  332</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#af6471778247e37185f213fc29ff2dfad">MarkerEventStatic</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span> (ARCH_LIKELY(!Category::IsEnabled()))</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        threadData-&gt;EmplaceEvent(</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            TraceEvent::Marker, key, Category::GetId());</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory, <span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a6aee2449d436b9327a839d8d865b0f86">  346</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a6aee2449d436b9327a839d8d865b0f86">StoreData</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key, <span class="keyword">const</span> T&amp; value) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (ARCH_UNLIKELY(Category::IsEnabled())) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            _StoreData(_GetThreadData(), key, Category::GetId(), value);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="class_trace_collector.html#a19b4d09df7c51c157bebc19f36339faf">  354</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a19b4d09df7c51c157bebc19f36339faf">RecordCounterDelta</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key, </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                            <span class="keywordtype">double</span> delta) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">// Only record counter values if the collector is enabled.</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> (ARCH_UNLIKELY(Category::IsEnabled())) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            threadData-&gt;EmplaceEvent(</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                TraceEvent::CounterDelta, key, delta, Category::GetId());</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="class_trace_collector.html#af8ced28b4c5e88606eff7108142c1910">  366</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#af8ced28b4c5e88606eff7108142c1910">RecordCounterDelta</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a> &amp;key, <span class="keywordtype">double</span> delta) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (ARCH_UNLIKELY(Category::IsEnabled())) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            threadData-&gt;CounterDelta(key, delta, Category::GetId());</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="class_trace_collector.html#aa30e743a52551ee5fd482dda7b04d894">  375</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#aa30e743a52551ee5fd482dda7b04d894">RecordCounterValue</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key, <span class="keywordtype">double</span> value) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// Only record counter values if the collector is enabled.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">if</span> (ARCH_UNLIKELY(Category::IsEnabled())) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            threadData-&gt;EmplaceEvent(</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                TraceEvent::CounterValue, key, value, Category::GetId());</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Category = DefaultCategory&gt;</div><div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="class_trace_collector.html#acce6cd85b39f0cafecf627d0b19d0f0c">  387</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#acce6cd85b39f0cafecf627d0b19d0f0c">RecordCounterValue</a>(<span class="keyword">const</span> <a class="code" href="class_trace_dynamic_key.html">Key</a> &amp;key, <span class="keywordtype">double</span> value) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">if</span> (ARCH_UNLIKELY(Category::IsEnabled())) {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            threadData-&gt;CounterValue(key, value, Category::GetId());</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="class_trace_collector.html#af1ec47098f4ada6664a7f25be4962cc4">  398</a></span>&#160;    <span class="keyword">const</span> std::string&amp; <a class="code" href="class_trace_collector.html#af1ec47098f4ada6664a7f25be4962cc4">GetLabel</a>() {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">return</span> _label;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    TRACE_API <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a6662f531d89c418a2266ecf7487c44a2">CreateCollection</a>();</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="class_trace_collector.html">TraceCollector</a>();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="class_tf_singleton.html">TfSingleton</a>&lt;<a class="code" href="class_trace_collector.html">TraceCollector</a>&gt;;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keyword">class </span>_PerThreadData;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// Return a pointer to existing per-thread data or create one if none</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// exists.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    TRACE_API _PerThreadData* _GetThreadData() noexcept;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    TRACE_API TimeStamp _BeginEvent(const Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    TRACE_API <span class="keywordtype">void</span> _BeginEventAtTime(</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        const Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    TRACE_API TimeStamp _EndEvent(const Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    TRACE_API <span class="keywordtype">void</span> _EndEventAtTime(</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;         const Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    TRACE_API TimeStamp _MarkerEvent(const Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    TRACE_API <span class="keywordtype">void</span> _MarkerEventAtTime(</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        const Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// This is the fast execution path called from the TRACE_FUNCTION</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// and TRACE_SCOPE macros</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">void</span> _BeginScope(const <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// Note we&#39;re not calling _NewEvent, don&#39;t need to cache key</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        _PerThreadData *threadData = _GetThreadData();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        threadData-&gt;BeginScope(key, cat);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// This is the fast execution path called from the TRACE_FUNCTION</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// and TRACE_SCOPE macros    </span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    TRACE_API <span class="keywordtype">void</span> _EndScope(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    TRACE_API <span class="keywordtype">void</span> _MeasureScopeOverhead();</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#ifdef PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// Callback function registered as a python tracing function.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">void</span> _PyTracingCallback(<span class="keyword">const</span> <a class="code" href="struct_tf_py_trace_info.html">TfPyTraceInfo</a> &amp;info);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">#endif // PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Implementation for small data that can stored inlined with the event.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T,</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keyword">typename</span> std::enable_if&lt;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keyword">sizeof</span>(T) &lt;= <span class="keyword">sizeof</span>(uintptr_t) </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            &amp;&amp; !std::is_pointer&lt;T&gt;::value , <span class="keywordtype">int</span>&gt;::type = 0&gt;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">void</span> _StoreData(_PerThreadData* threadData, <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key,</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat, <span class="keyword">const</span> T&amp; value) {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        threadData-&gt;StoreData(key, value, cat);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// Implementation for data that must be stored outside of the events.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keyword">typename</span> std::enable_if&lt;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            (<span class="keyword">sizeof</span>(T) &gt; <span class="keyword">sizeof</span>(uintptr_t))</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            &amp;&amp; !std::is_pointer&lt;T&gt;::value, <span class="keywordtype">int</span>&gt;::type = 0&gt;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">void</span> _StoreData(_PerThreadData* threadData, <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat,  <span class="keyword">const</span> T&amp; value) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        threadData-&gt;StoreLargeData(key, value, cat);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// Specialization for c string</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">void</span> _StoreData(</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        _PerThreadData* threadData, </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key, </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat, </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* value) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        threadData-&gt;StoreLargeData(key, value, cat);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// Specialization for std::string</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">void</span> _StoreData(</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        _PerThreadData* threadData,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a> &amp;key,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat, </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keyword">const</span> std::string&amp; value) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        threadData-&gt;StoreLargeData(key, value.c_str(), cat);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// Variadic version to store multiple data events in one function call.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">void</span> _StoreDataRec(</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        _PerThreadData* threadData, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat, K&amp;&amp; key, </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keyword">const</span> T&amp; value, Args&amp;&amp;... args) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        _StoreData(threadData, std::forward&lt;K&gt;(key), cat, value);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        _StoreDataRec(threadData, cat, std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// Base case to terminate template recursion</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">void</span> _StoreDataRec(_PerThreadData* threadData, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {}</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// Thread-local storage, accessed via _GetThreadData()</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">class </span>_PerThreadData {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keyword">public</span>:</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keyword">using</span> EventList = <a class="code" href="class_trace_event_list.html">TraceCollection::EventList</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            _PerThreadData();</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            ~_PerThreadData();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keyword">const</span> <a class="code" href="class_trace_thread_id.html">TraceThreadId</a>&amp; GetThreadId()<span class="keyword"> const </span>{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">return</span> _threadIndex;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            TimeStamp <a class="code" href="class_trace_collector.html#abe87d69be453135038d83c3c0ec7aaa7">BeginEvent</a>(<span class="keyword">const</span> Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            TimeStamp <a class="code" href="class_trace_collector.html#a434e0b198a0cdb83acf662439f19f237">EndEvent</a>(<span class="keyword">const</span> Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            TimeStamp <a class="code" href="class_trace_collector.html#a1a3a887bb79fceffb57ea09b53aa2802">MarkerEvent</a>(<span class="keyword">const</span> Key&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="comment">// Debug Methods</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a1132b5470b89934547dd8ea78144b9a4">BeginEventAtTime</a>(</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keyword">const</span> Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a1f9e33b267232faeb121ea52954782af">EndEventAtTime</a>(<span class="keyword">const</span> Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a762c7dc7ed10c95e86c4eda42303e9a2">MarkerEventAtTime</a>(<span class="keyword">const</span> Key&amp; key, <span class="keywordtype">double</span> ms, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a409090b70e87d4d47a9a37f6e3b07aee">BeginScope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                AtomicRef lock(_writing);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                _BeginScope(key, cat);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#adf33c1ce0c294c2c5e96109f87a73b35">EndScope</a>(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                AtomicRef lock(_writing);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                _EndScope(key, cat);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            TRACE_API <span class="keywordtype">void</span> CounterDelta(</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keyword">const</span> Key&amp;, <span class="keywordtype">double</span> value, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            TRACE_API <span class="keywordtype">void</span> CounterValue(</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <span class="keyword">const</span> Key&amp;, <span class="keywordtype">double</span> value, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a6aee2449d436b9327a839d8d865b0f86">StoreData</a>(</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <span class="keyword">const</span> T&amp; data, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                AtomicRef lock(_writing);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                _events.load(std::memory_order_acquire)-&gt;EmplaceBack(</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    TraceEvent::Data, key, data, cat);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordtype">void</span> StoreLargeData(</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <span class="keyword">const</span> T&amp; data, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                AtomicRef lock(_writing);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                EventList* events = _events.load(std::memory_order_acquire);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span>* cached = events-&gt;StoreData(data);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                events-&gt;EmplaceBack(TraceEvent::Data, key, cached, cat);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordtype">void</span> EmplaceEvent(Args&amp;&amp;... args) {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                AtomicRef lock(_writing);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                _events.load(std::memory_order_acquire)-&gt;EmplaceBack(</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                    std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#ifdef PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordtype">void</span> PushPyScope(<span class="keyword">const</span> Key&amp; key, <span class="keywordtype">bool</span> enabled);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordtype">void</span> PopPyScope(<span class="keywordtype">bool</span> enabled);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#endif // PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">// These methods can be called from threads at the same time as the </span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="comment">// other methods.</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            std::unique_ptr&lt;EventList&gt; GetCollectionData();</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_trace_collector.html#a91e32d7011f5bc3bd911b87e30b02ba3">Clear</a>();</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">private</span>:</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordtype">void</span> _BeginScope(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                _events.load(std::memory_order_acquire)-&gt;EmplaceBack(</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    TraceEvent::Begin, key, cat);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordtype">void</span> _EndScope(<span class="keyword">const</span> <a class="code" href="class_trace_key.html">TraceKey</a>&amp; key, <a class="code" href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a> cat);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="comment">// Flag to let other threads know that the list is being written to.</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keyword">mutable</span> std::atomic&lt;bool&gt; _writing;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            std::atomic&lt;EventList*&gt; _events;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keyword">class </span>AtomicRef {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keyword">public</span>:</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                AtomicRef(std::atomic&lt;bool&gt;&amp; b) : _bool(b) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    _bool.store(<span class="keyword">true</span>, std::memory_order_release);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                ~AtomicRef() {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    _bool.store(<span class="keyword">false</span>, std::memory_order_release);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keyword">private</span>:</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                std::atomic&lt;bool&gt;&amp; _bool;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            };</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="comment">// An integer that is unique for each thread launched by any</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">// threadDispatcher.  Each time a thread is Start-ed it get&#39;s</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">// a new id.</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="class_trace_thread_id.html">TraceThreadId</a> _threadIndex;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="comment">// When auto-tracing python frames, this stores the stack of scopes.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keyword">struct </span>PyScope {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                Key key;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            };</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            std::vector&lt;PyScope&gt; _pyScopes;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    };</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    TRACE_API <span class="keyword">static</span> std::atomic&lt;int&gt; _isEnabled;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// A list with one _PerThreadData per thread.</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="class_trace_concurrent_list.html">TraceConcurrentList&lt;_PerThreadData&gt;</a> _allPerThreadData;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    std::string _label;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    TimeStamp _measuredScopeOverhead;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">// These members are unused if Python support is disabled. However, we</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// leave them in place and just mark them unused to provide ABI</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// compatibility between USD builds with and without Python enabled.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#ifndef PXR_PYTHON_SUPPORT_ENABLED    </span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    ARCH_PRAGMA_PUSH</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    ARCH_PRAGMA_UNUSED_PRIVATE_FIELD</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    std::atomic&lt;int&gt; _isPythonTracingEnabled;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    TfPyTraceFnId _pyTraceFnId;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">#ifndef PXR_PYTHON_SUPPORT_ENABLED</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    ARCH_PRAGMA_POP</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;};</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;TRACE_API_TEMPLATE_CLASS(<a class="code" href="class_tf_singleton.html">TfSingleton&lt;TraceCollector&gt;</a>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;PXR_NAMESPACE_CLOSE_SCOPE</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#endif // PXR_BASE_TRACE_COLLECTOR_H</span></div><div class="ttc" id="class_trace_collector_html_af1ec47098f4ada6664a7f25be4962cc4"><div class="ttname"><a href="class_trace_collector.html#af1ec47098f4ada6664a7f25be4962cc4">TraceCollector::GetLabel</a></div><div class="ttdeci">const std::string &amp; GetLabel()</div><div class="ttdoc">Return the label associated with this collector.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00398">collector.h:398</a></div></div>
<div class="ttc" id="struct_trace_collector_1_1_default_category_html_a8a49d253d7a89ed87906e2ac33c48eaa"><div class="ttname"><a href="struct_trace_collector_1_1_default_category.html#a8a49d253d7a89ed87906e2ac33c48eaa">TraceCollector::DefaultCategory::IsEnabled</a></div><div class="ttdeci">static bool IsEnabled()</div><div class="ttdoc">Returns the result of TraceCollector::IsEnabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00104">collector.h:104</a></div></div>
<div class="ttc" id="class_trace_collector_html_a6aee2449d436b9327a839d8d865b0f86"><div class="ttname"><a href="class_trace_collector.html#a6aee2449d436b9327a839d8d865b0f86">TraceCollector::StoreData</a></div><div class="ttdeci">void StoreData(const TraceKey &amp;key, const T &amp;value)</div><div class="ttdoc">Record a data event with the given key and value if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00346">collector.h:346</a></div></div>
<div class="ttc" id="singleton_8h_html"><div class="ttname"><a href="singleton_8h.html">singleton.h</a></div><div class="ttdoc">Manage a single instance of an object.</div></div>
<div class="ttc" id="class_trace_collector_html_a6662f531d89c418a2266ecf7487c44a2"><div class="ttname"><a href="class_trace_collector.html#a6662f531d89c418a2266ecf7487c44a2">TraceCollector::CreateCollection</a></div><div class="ttdeci">TRACE_API void CreateCollection()</div><div class="ttdoc">Produces a TraceCollection from all the events that recorded in the collector and issues a TraceColle...</div></div>
<div class="ttc" id="class_trace_collector_html_a0bd350fc68d56a8bb66c20531e7d3587"><div class="ttname"><a href="class_trace_collector.html#a0bd350fc68d56a8bb66c20531e7d3587">TraceCollector::SetEnabled</a></div><div class="ttdeci">TRACE_API void SetEnabled(bool isEnabled)</div><div class="ttdoc">Enables or disables collection of events for DefaultCategory.</div></div>
<div class="ttc" id="pragmas_8h_html"><div class="ttname"><a href="pragmas_8h.html">pragmas.h</a></div><div class="ttdoc">Pragmas for controlling compiler-specific behaviors.</div></div>
<div class="ttc" id="class_tf_singleton_html"><div class="ttname"><a href="class_tf_singleton.html">TfSingleton</a></div><div class="ttdoc">Manage a single instance of an object (see.</div><div class="ttdef"><b>Definition:</b> <a href="singleton_8h_source.html#l00122">singleton.h:122</a></div></div>
<div class="ttc" id="class_trace_collector_html_acce6cd85b39f0cafecf627d0b19d0f0c"><div class="ttname"><a href="class_trace_collector.html#acce6cd85b39f0cafecf627d0b19d0f0c">TraceCollector::RecordCounterValue</a></div><div class="ttdeci">void RecordCounterValue(const Key &amp;key, double value)</div><div class="ttdoc">Record a counter value for a name key and delta value if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00387">collector.h:387</a></div></div>
<div class="ttc" id="class_trace_collector_html_a1132b5470b89934547dd8ea78144b9a4"><div class="ttname"><a href="class_trace_collector.html#a1132b5470b89934547dd8ea78144b9a4">TraceCollector::BeginEventAtTime</a></div><div class="ttdeci">void BeginEventAtTime(const Key &amp;key, double ms)</div><div class="ttdoc">Record a begin event with key at a specified time if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00149">collector.h:149</a></div></div>
<div class="ttc" id="declare_ptrs_8h_html_a5435f413811b6758dc658a6ab0932e11"><div class="ttname"><a href="declare_ptrs_8h.html#a5435f413811b6758dc658a6ab0932e11">TF_DECLARE_WEAK_PTRS</a></div><div class="ttdeci">#define TF_DECLARE_WEAK_PTRS(type)</div><div class="ttdoc">Define standard weak pointer types.</div><div class="ttdef"><b>Definition:</b> <a href="declare_ptrs_8h_source.html#l00062">declarePtrs.h:62</a></div></div>
<div class="ttc" id="declare_ptrs_8h_html"><div class="ttname"><a href="declare_ptrs_8h.html">declarePtrs.h</a></div><div class="ttdoc">Standard pointer typedefs.</div></div>
<div class="ttc" id="class_trace_collector_html_af6471778247e37185f213fc29ff2dfad"><div class="ttname"><a href="class_trace_collector.html#af6471778247e37185f213fc29ff2dfad">TraceCollector::MarkerEventStatic</a></div><div class="ttdeci">void MarkerEventStatic(const TraceKey &amp;key)</div><div class="ttdoc">Record a scope event described by key that started at start if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00332">collector.h:332</a></div></div>
<div class="ttc" id="class_trace_collector_html_a762c7dc7ed10c95e86c4eda42303e9a2"><div class="ttname"><a href="class_trace_collector.html#a762c7dc7ed10c95e86c4eda42303e9a2">TraceCollector::MarkerEventAtTime</a></div><div class="ttdeci">void MarkerEventAtTime(const Key &amp;key, double ms)</div><div class="ttdoc">Record a marker event with key at a specified time if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00204">collector.h:204</a></div></div>
<div class="ttc" id="class_trace_collector_html_a434e0b198a0cdb83acf662439f19f237"><div class="ttname"><a href="class_trace_collector.html#a434e0b198a0cdb83acf662439f19f237">TraceCollector::EndEvent</a></div><div class="ttdeci">TimeStamp EndEvent(const Key &amp;key)</div><div class="ttdoc">Record an end event with key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00165">collector.h:165</a></div></div>
<div class="ttc" id="class_trace_thread_id_html"><div class="ttname"><a href="class_trace_thread_id.html">TraceThreadId</a></div><div class="ttdoc">This class represents an identifier for a thread.</div><div class="ttdef"><b>Definition:</b> <a href="trace_2threads_8h_source.html#l00040">threads.h:40</a></div></div>
<div class="ttc" id="ref_base_8h_html"><div class="ttname"><a href="ref_base_8h.html">refBase.h</a></div></div>
<div class="ttc" id="class_trace_event_html_a166027cc433a33197d502f882979d160"><div class="ttname"><a href="class_trace_event.html#a166027cc433a33197d502f882979d160">TraceEvent::TimeStamp</a></div><div class="ttdeci">uint64_t TimeStamp</div><div class="ttdoc">Time in &quot;ticks&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00050">event.h:50</a></div></div>
<div class="ttc" id="class_trace_collector_html_aa30e743a52551ee5fd482dda7b04d894"><div class="ttname"><a href="class_trace_collector.html#aa30e743a52551ee5fd482dda7b04d894">TraceCollector::RecordCounterValue</a></div><div class="ttdeci">void RecordCounterValue(const TraceKey &amp;key, double value)</div><div class="ttdoc">Record a counter value for a name key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00375">collector.h:375</a></div></div>
<div class="ttc" id="class_trace_collector_html_a1268fce31f204097d83a3203583242cb"><div class="ttname"><a href="class_trace_collector.html#a1268fce31f204097d83a3203583242cb">TraceCollector::IsPythonTracingEnabled</a></div><div class="ttdeci">bool IsPythonTracingEnabled() const</div><div class="ttdoc">Returns whether automatic tracing of all python scopes is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00109">collector.h:109</a></div></div>
<div class="ttc" id="weak_ptr_8h_html"><div class="ttname"><a href="weak_ptr_8h.html">weakPtr.h</a></div><div class="ttdoc">Pointer storage with deletion detection.</div></div>
<div class="ttc" id="declare_ptrs_8h_html_a82e60c4622cb84bba86c7ef61d37bf1f"><div class="ttname"><a href="declare_ptrs_8h.html#a82e60c4622cb84bba86c7ef61d37bf1f">TF_DECLARE_WEAK_AND_REF_PTRS</a></div><div class="ttdeci">#define TF_DECLARE_WEAK_AND_REF_PTRS(type)</div><div class="ttdoc">Define standard weak, ref, and vector pointer types.</div><div class="ttdef"><b>Definition:</b> <a href="declare_ptrs_8h_source.html#l00089">declarePtrs.h:89</a></div></div>
<div class="ttc" id="struct_trace_collector_1_1_default_category_html_a3d2ea348b0bdf811577736f2b311057b"><div class="ttname"><a href="struct_trace_collector_1_1_default_category.html#a3d2ea348b0bdf811577736f2b311057b">TraceCollector::DefaultCategory::GetId</a></div><div class="ttdeci">static constexpr TraceCategoryId GetId()</div><div class="ttdoc">Returns TraceCategory::Default.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00102">collector.h:102</a></div></div>
<div class="ttc" id="class_trace_collector_html_a91e32d7011f5bc3bd911b87e30b02ba3"><div class="ttname"><a href="class_trace_collector.html#a91e32d7011f5bc3bd911b87e30b02ba3">TraceCollector::Clear</a></div><div class="ttdeci">TRACE_API void Clear()</div><div class="ttdoc">Clear all pending events from the collector.</div></div>
<div class="ttc" id="class_trace_dynamic_key_html"><div class="ttname"><a href="class_trace_dynamic_key.html">TraceDynamicKey</a></div><div class="ttdoc">This class stores data used to create dynamic keys which can be referenced in TraceEvent instances.</div><div class="ttdef"><b>Definition:</b> <a href="dynamic_key_8h_source.html#l00042">dynamicKey.h:42</a></div></div>
<div class="ttc" id="class_trace_concurrent_list_html"><div class="ttname"><a href="class_trace_concurrent_list.html">TraceConcurrentList&lt; _PerThreadData &gt;</a></div></div>
<div class="ttc" id="class_trace_collector_html_abe87d69be453135038d83c3c0ec7aaa7"><div class="ttname"><a href="class_trace_collector.html#abe87d69be453135038d83c3c0ec7aaa7">TraceCollector::BeginEvent</a></div><div class="ttdeci">TimeStamp BeginEvent(const Key &amp;key)</div><div class="ttdoc">Record a begin event with key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00136">collector.h:136</a></div></div>
<div class="ttc" id="class_trace_collector_html_ae40874970bad02a56bd51bfaff68e6b4"><div class="ttname"><a href="class_trace_collector.html#ae40874970bad02a56bd51bfaff68e6b4">TraceCollector::BeginScope</a></div><div class="ttdeci">void BeginScope(const TraceKey &amp;key, Args &amp;&amp;... args)</div><div class="ttdoc">Record a begin event for a scope described by key and store data arguments if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00248">collector.h:248</a></div></div>
<div class="ttc" id="class_trace_collector_html_ace377a05040cb48b00e186d64ecff1b3"><div class="ttname"><a href="class_trace_collector.html#ace377a05040cb48b00e186d64ecff1b3">TraceCollector::Scope</a></div><div class="ttdeci">void Scope(const TraceKey &amp;key, TimeStamp start, TimeStamp stop)</div><div class="ttdoc">Record a scope event described by key that started at start if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00287">collector.h:287</a></div></div>
<div class="ttc" id="struct_trace_collector_1_1_default_category_html"><div class="ttname"><a href="struct_trace_collector_1_1_default_category.html">TraceCollector::DefaultCategory</a></div><div class="ttdoc">Default Trace category which corresponds to events stored for TRACE_ macros.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00100">collector.h:100</a></div></div>
<div class="ttc" id="class_trace_collector_html_a1f9e33b267232faeb121ea52954782af"><div class="ttname"><a href="class_trace_collector.html#a1f9e33b267232faeb121ea52954782af">TraceCollector::EndEventAtTime</a></div><div class="ttdeci">void EndEventAtTime(const Key &amp;key, double ms)</div><div class="ttdoc">Record an end event with key at a specified time if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00178">collector.h:178</a></div></div>
<div class="ttc" id="class_trace_collector_html_aeb08fa7315890082f202886a99206c91"><div class="ttname"><a href="class_trace_collector.html#aeb08fa7315890082f202886a99206c91">TraceCollector::BeginScope</a></div><div class="ttdeci">void BeginScope(const TraceKey &amp;key, Args &amp;&amp;... args)</div><div class="ttdoc">Record a begin event for a scope described by key and a specified category and store data arguments i...</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00230">collector.h:230</a></div></div>
<div class="ttc" id="class_trace_collector_html_a277b6997c6804dd968251827991ad5a0"><div class="ttname"><a href="class_trace_collector.html#a277b6997c6804dd968251827991ad5a0">TraceCollector::ScopeArgs</a></div><div class="ttdeci">void ScopeArgs(Args &amp;&amp;... args)</div><div class="ttdoc">Record multiple data events with the default category if collection of events is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00317">collector.h:317</a></div></div>
<div class="ttc" id="class_trace_collector_html_a1a3a887bb79fceffb57ea09b53aa2802"><div class="ttname"><a href="class_trace_collector.html#a1a3a887bb79fceffb57ea09b53aa2802">TraceCollector::MarkerEvent</a></div><div class="ttdeci">TimeStamp MarkerEvent(const Key &amp;key)</div><div class="ttdoc">Record a marker event with key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00191">collector.h:191</a></div></div>
<div class="ttc" id="class_trace_collector_html_a7c6ef45a242396370e5d51e4c0ed8ec7"><div class="ttname"><a href="class_trace_collector.html#a7c6ef45a242396370e5d51e4c0ed8ec7">TraceCollector::GetInstance</a></div><div class="ttdeci">static TRACE_API TraceCollector &amp; GetInstance()</div><div class="ttdoc">Returns the singleton instance.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00084">collector.h:84</a></div></div>
<div class="ttc" id="pxr_8h_html"><div class="ttname"><a href="pxr_8h.html">pxr.h</a></div></div>
<div class="ttc" id="class_trace_collector_html"><div class="ttname"><a href="class_trace_collector.html">TraceCollector</a></div><div class="ttdoc">This is a singleton class that records TraceEvent instances and populates TraceCollection instances.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00071">collector.h:71</a></div></div>
<div class="ttc" id="class_trace_collector_html_adf33c1ce0c294c2c5e96109f87a73b35"><div class="ttname"><a href="class_trace_collector.html#adf33c1ce0c294c2c5e96109f87a73b35">TraceCollector::EndScope</a></div><div class="ttdeci">void EndScope(const TraceKey &amp;key)</div><div class="ttdoc">Record an end event described by key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00263">collector.h:263</a></div></div>
<div class="ttc" id="class_trace_collector_html_af8ced28b4c5e88606eff7108142c1910"><div class="ttname"><a href="class_trace_collector.html#af8ced28b4c5e88606eff7108142c1910">TraceCollector::RecordCounterDelta</a></div><div class="ttdeci">void RecordCounterDelta(const Key &amp;key, double delta)</div><div class="ttdoc">Record a counter delta for a name key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00366">collector.h:366</a></div></div>
<div class="ttc" id="struct_tf_py_trace_info_html"><div class="ttname"><a href="struct_tf_py_trace_info.html">TfPyTraceInfo</a></div><div class="ttdoc">Structure passed to python trace functions.</div><div class="ttdef"><b>Definition:</b> <a href="py_tracing_8h_source.html#l00044">pyTracing.h:44</a></div></div>
<div class="ttc" id="class_tf_singleton_html_a0866aab4257483326c469dcef942f0e1"><div class="ttname"><a href="class_tf_singleton.html#a0866aab4257483326c469dcef942f0e1">TfSingleton::GetInstance</a></div><div class="ttdeci">static T &amp; GetInstance()</div><div class="ttdoc">Return a reference to an object of type T, creating it if necessary.</div><div class="ttdef"><b>Definition:</b> <a href="singleton_8h_source.html#l00137">singleton.h:137</a></div></div>
<div class="ttc" id="class_trace_collector_html_a409090b70e87d4d47a9a37f6e3b07aee"><div class="ttname"><a href="class_trace_collector.html#a409090b70e87d4d47a9a37f6e3b07aee">TraceCollector::BeginScope</a></div><div class="ttdeci">void BeginScope(const TraceKey &amp;_key)</div><div class="ttdoc">Record a begin event for a scope described by key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00217">collector.h:217</a></div></div>
<div class="ttc" id="class_trace_collector_html_a81f8d63e47276778589f4642747829d7"><div class="ttname"><a href="class_trace_collector.html#a81f8d63e47276778589f4642747829d7">TraceCollector::Scope</a></div><div class="ttdeci">static TRACE_API void Scope(const TraceKey &amp;key, TimeStamp start, TimeStamp stop) noexcept</div><div class="ttdoc">Record a scope event described by key that started at start for the DefaultCategory.</div></div>
<div class="ttc" id="class_trace_event_list_html"><div class="ttname"><a href="class_trace_event_list.html">TraceEventList</a></div><div class="ttdoc">This class represents an ordered collection of TraceEvents and the TraceDynamicKeys and data that the...</div><div class="ttdef"><b>Definition:</b> <a href="event_list_8h_source.html#l00046">eventList.h:46</a></div></div>
<div class="ttc" id="ref_ptr_8h_html"><div class="ttname"><a href="ref_ptr_8h.html">refPtr.h</a></div><div class="ttdoc">Reference counting.</div></div>
<div class="ttc" id="class_trace_collector_html_a8a49d253d7a89ed87906e2ac33c48eaa"><div class="ttname"><a href="class_trace_collector.html#a8a49d253d7a89ed87906e2ac33c48eaa">TraceCollector::IsEnabled</a></div><div class="ttdeci">static bool IsEnabled()</div><div class="ttdoc">Returns whether collection of events is enabled for DefaultCategory.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00094">collector.h:94</a></div></div>
<div class="ttc" id="class_trace_collector_html_a320516bf4af4be3d9008d85c23ecd94c"><div class="ttname"><a href="class_trace_collector.html#a320516bf4af4be3d9008d85c23ecd94c">TraceCollector::SetPythonTracingEnabled</a></div><div class="ttdeci">TRACE_API void SetPythonTracingEnabled(bool enabled)</div><div class="ttdoc">Set whether automatic tracing of all python scopes is enabled.</div></div>
<div class="ttc" id="class_trace_collector_html_ab38f463eea3fee1a8be24cde3590b34c"><div class="ttname"><a href="class_trace_collector.html#ab38f463eea3fee1a8be24cde3590b34c">TraceCollector::GetScopeOverhead</a></div><div class="ttdeci">TRACE_API TimeStamp GetScopeOverhead() const</div><div class="ttdoc">Return the overhead cost to measure a scope.</div></div>
<div class="ttc" id="category_8h_html_a3a221cd36270fa5e1bee9476d0c6013e"><div class="ttname"><a href="category_8h.html#a3a221cd36270fa5e1bee9476d0c6013e">TraceCategoryId</a></div><div class="ttdeci">uint32_t TraceCategoryId</div><div class="ttdoc">Categories that a TraceReporter can use to filter events.</div><div class="ttdef"><b>Definition:</b> <a href="category_8h_source.html#l00044">category.h:44</a></div></div>
<div class="ttc" id="class_tf_weak_base_html"><div class="ttname"><a href="class_tf_weak_base.html">TfWeakBase</a></div><div class="ttdoc">Enable a concrete base class for use with TfWeakPtr.</div><div class="ttdef"><b>Definition:</b> <a href="weak_base_8h_source.html#l00141">weakBase.h:141</a></div></div>
<div class="ttc" id="class_trace_collector_html_a19b4d09df7c51c157bebc19f36339faf"><div class="ttname"><a href="class_trace_collector.html#a19b4d09df7c51c157bebc19f36339faf">TraceCollector::RecordCounterDelta</a></div><div class="ttdeci">void RecordCounterDelta(const TraceKey &amp;key, double delta)</div><div class="ttdoc">Record a counter delta for a name key if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00354">collector.h:354</a></div></div>
<div class="ttc" id="weak_base_8h_html"><div class="ttname"><a href="weak_base_8h.html">weakBase.h</a></div></div>
<div class="ttc" id="malloc_tag_8h_html"><div class="ttname"><a href="malloc_tag_8h.html">mallocTag.h</a></div></div>
<div class="ttc" id="class_trace_collector_html_a85f42c728e71ba00dee09dda22a93ac7"><div class="ttname"><a href="class_trace_collector.html#a85f42c728e71ba00dee09dda22a93ac7">TraceCollector::ScopeArgs</a></div><div class="ttdeci">void ScopeArgs(Args &amp;&amp;... args)</div><div class="ttdoc">Record multiple data events with category cat if Category is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="collector_8h_source.html#l00299">collector.h:299</a></div></div>
<div class="ttc" id="class_trace_key_html"><div class="ttname"><a href="class_trace_key.html">TraceKey</a></div><div class="ttdoc">A wrapper around a TraceStaticKeyData pointer that is stored in TraceEvent instances.</div><div class="ttdef"><b>Definition:</b> <a href="key_8h_source.html#l00040">key.h:40</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1d43f220d4da368b75944030615bc443.html">pxr</a></li><li class="navelem"><a class="el" href="dir_682898b56c69f5cabb813635d1588cf1.html">base</a></li><li class="navelem"><a class="el" href="dir_f8a011d013375ee9e7a678f2f2849b7d.html">trace</a></li><li class="navelem"><b>collector.h</b></li>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:46 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>