<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: HdEmbree : Embree-based hydra renderer plugin.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hd_embree_page_front.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">HdEmbree : Embree-based hydra renderer plugin. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="hdEmbree_mainpage"></a> </p><h2>Classes</h2>
<ul>
<li><a class="el" href="class_hd_embree_config.html" title="This class is a singleton, holding configuration parameters for HdEmbree.">HdEmbreeConfig</a></li>
<li><a class="el" href="class_hd_embree_instancer.html" title="HdEmbree implements instancing by adding prototype geometry to the BVH multiple times within HdEmbree...">HdEmbreeInstancer</a></li>
<li><a class="el" href="class_hd_embree_mesh.html" title="An HdEmbree representation of a subdivision surface or poly-mesh object.">HdEmbreeMesh</a></li>
<li><a class="el" href="class_hd_embree_renderer_plugin.html" title="A registered child of HdRendererPlugin, this is the class that gets loaded when a hydra application a...">HdEmbreeRendererPlugin</a></li>
<li><a class="el" href="class_hd_embree_render_delegate.html" title="Render delegates provide renderer-specific functionality to the render index, the main hydra state ma...">HdEmbreeRenderDelegate</a></li>
<li><a class="el" href="class_hd_embree_render_param.html" title="The render delegate can create an object of type HdRenderParam, to pass to each prim during Sync().">HdEmbreeRenderParam</a></li>
<li><a class="el" href="class_hd_embree_render_pass.html" title="HdRenderPass represents a single render iteration, rendering a view of the scene (the HdRprimCollecti...">HdEmbreeRenderPass</a></li>
<li><a class="el" href="class_hd_embree_renderer.html" title="HdEmbreeRenderer implements a renderer on top of Embree&#39;s raycasting abilities.">HdEmbreeRenderer</a></li>
</ul>
<h2>Overview</h2>
<p>HdEmbree implements a Hydra renderer plugin based on Intel's Embree raytracing kernels. HdEmbree is provided as a minimal example of how to write a renderer plugin for hydra; it aims to be living documentation of that API.</p>
<p>The embree API is prefixed by "rtc", for raytracing core, and documentation is available <a href="https://embree.github.io/api.html">here</a>.</p>
<p>The hydra image generation algorithm (as implemented in <a class="el" href="class_hd_engine.html#a75a0815239165c0bf1826a09415013a5" title="Execute tasks.">HdEngine::Execute</a>) has three main phases: sync, commit resources, and execution of tasks. At each point, hydra delegates some responsibility to the renderer plugin.</p>
<h2>Sync</h2>
<p>Hydra tracks scene state in the <a class="el" href="class_hd_render_index.html" title="The Hydra render index is a flattened representation of the client scene graph, which may be composed...">HdRenderIndex</a> datastructure. Before generating images, hydra updates scene state with <a class="el" href="class_hd_render_index.html#a4c0c8384764f03418660e24b66fa4c90" title="Syncs input tasks, B &amp; S prims, (external) computations and updates the Rprim dirty list to then sync...">HdRenderIndex::SyncAll()</a>. Each prim (scene object) is bound to an <a class="el" href="class_hd_scene_delegate.html" title="Adapter class providing data exchange with the client scene graph.">HdSceneDelegate</a> object, which acts as its datasource; SyncAll loops through each prim calling Sync(), which pulls new scene data from the scene delegate and updates the renderable representation.</p>
<p>The render index uses an instance of HdRenderDelegate to create prim classes, and render delegates are specialized for each renderer so that they can create the appropriate renderable representation. HdEmbree provides <a class="el" href="class_hd_embree_render_delegate.html" title="Render delegates provide renderer-specific functionality to the render index, the main hydra state ma...">HdEmbreeRenderDelegate</a>, which can create <a class="el" href="class_hd_embree_instancer.html" title="HdEmbree implements instancing by adding prototype geometry to the BVH multiple times within HdEmbree...">HdEmbreeInstancer</a> and <a class="el" href="class_hd_embree_mesh.html" title="An HdEmbree representation of a subdivision surface or poly-mesh object.">HdEmbreeMesh</a>. Together, these classes insert mesh objects and mesh instances into the embree scene, so that drawing code can raycast against them.</p>
<p>In order to support the standard hydra render task, <a class="el" href="class_hdx_render_task.html" title="A task for rendering geometry to pixels.">HdxRenderTask</a>, the scene delegate also supports a basic camera type, <a class="el" href="class_hd_camera.html" title="Hydra schema for a camera that pulls the params (see above) during Sync.">HdCamera</a>.</p>
<h2>Commit Resources</h2>
<p>After updating the render index, but before running tasks, <a class="el" href="class_hd_engine.html#a75a0815239165c0bf1826a09415013a5" title="Execute tasks.">HdEngine::Execute()</a> calls the render delegate's CommitResources(). This gives the renderer a chance to commit the results of the sync phase, e.g. by copying buffers to the GPU or doing a final rebuild of intersection datastructures. HdEmbree doesn't use this, instead deferring bvh rebuilds to the next Render() call.</p>
<h2>Executing tasks</h2>
<p>The last phase of <a class="el" href="class_hd_engine.html#a75a0815239165c0bf1826a09415013a5" title="Execute tasks.">HdEngine::Execute()</a> is running tasks. Hydra tasks are schedulable callbacks that can be used to render, to maintain scene state, or to interleave execution with other renderers or libraries.</p>
<p>Hydra provides <a class="el" href="class_hdx_render_task.html" title="A task for rendering geometry to pixels.">HdxRenderTask</a> as a way to simply render a scene. <a class="el" href="class_hdx_render_task.html" title="A task for rendering geometry to pixels.">HdxRenderTask</a> takes a collection and render parameters as inputs, and maps them to a render pass, created by the render delegate. Collections specify which parts of the scene to draw (by include/exclude paths), and how to draw them (via the repr token).</p>
<p>HdEmbree provides <a class="el" href="class_hd_embree_render_pass.html" title="HdRenderPass represents a single render iteration, rendering a view of the scene (the HdRprimCollecti...">HdEmbreeRenderPass</a>, which draws by raycasting into the embree scene that's been populated by HdEmbree prim objects. The raycasting is done in the helper <a class="el" href="class_hd_embree_renderer.html" title="HdEmbreeRenderer implements a renderer on top of Embree&#39;s raycasting abilities.">HdEmbreeRenderer</a> class. Outputs are written into <a class="el" href="class_hd_render_buffer.html" title="A render buffer is a handle to a data resource that can be rendered into, such as a 2d image for a dr...">HdRenderBuffer</a> objects, which represent image data. Typically, auxiliary tasks in hdx will blit these into the GL framebuffer.</p>
<p>Note: <a class="el" href="class_hd_embree_render_pass.html" title="HdRenderPass represents a single render iteration, rendering a view of the scene (the HdRprimCollecti...">HdEmbreeRenderPass</a> currently doesn't support collection include/exclude paths, so it draws everything in every renderpass. Rendering with multiple embree render passes is unsupported, since they'll write over each other instead of compositing.</p>
<h2>Renderer Plugin</h2>
<p>HdEmbree fits into the hydra runtime as a plugin, and the discoverable class is <a class="el" href="class_hd_embree_renderer_plugin.html" title="A registered child of HdRendererPlugin, this is the class that gets loaded when a hydra application a...">HdEmbreeRendererPlugin</a>. The plugin class's only responsibility is to create instances of <a class="el" href="class_hd_embree_render_delegate.html" title="Render delegates provide renderer-specific functionality to the render index, the main hydra state ma...">HdEmbreeRenderDelegate</a>.</p>
<h2>Embree Scene Ownership</h2>
<p>The embree scene that renderpasses raycast against lives in <a class="el" href="class_hd_embree_render_delegate.html" title="Render delegates provide renderer-specific functionality to the render index, the main hydra state ma...">HdEmbreeRenderDelegate</a>. Because of this, each render index should have a distinct render delegate. The scene is passed to prims during Sync() via the <a class="el" href="class_hd_embree_render_param.html" title="The render delegate can create an object of type HdRenderParam, to pass to each prim during Sync().">HdEmbreeRenderParam</a> object, and the scene is passed to the renderer object on creation; the renderpass, in turn, gets a handle to the renderer on creation.</p>
<h2>Configuration</h2>
<p>Embree exports some configuration parameters, controllable by environment variable, through the <a class="el" href="class_hd_embree_config.html" title="This class is a singleton, holding configuration parameters for HdEmbree.">HdEmbreeConfig</a> class.</p>
<h2>Unit Test</h2>
<p>testHdEmbree provides an example of how to write a minimal hydra application. It uses HdSt_UnitTestGLDrawing to create a window and provide a GL framebuffer, and Hd_UnitTestDelegate to provide a simple scene graph/data source. The scene is then rendered by running <a class="el" href="class_hdx_render_task.html" title="A task for rendering geometry to pixels.">HdxRenderTask</a> via <a class="el" href="class_hd_engine.html#a75a0815239165c0bf1826a09415013a5" title="Execute tasks.">HdEngine::Execute()</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:57 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>