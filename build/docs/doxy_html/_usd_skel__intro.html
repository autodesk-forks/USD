<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Universal Scene Description: UsdSkel Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="usd_style.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="https://openusd.org/images/USDIcon.ico"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add warning banner to top of page if current page isn't the release version -->
<script>
function AddWarningBanner() 
{
  // Get current URL
  const loc = new URL(location.href);
  // Look for URL of the format "<USD hostname>/<version|dev|release>/api/<file.html>"
  // NOTE: If versioning approach ever changes, this will need updating
  var apiIndex = loc.pathname.indexOf("/api/");
  if (apiIndex >= 0) {
    // Truncate "/api/..." off path to get preceding path and "/" index
    var truncString = loc.pathname.slice(0,apiIndex);
    // Get index of first "/" before "/api/"
    var preApiIndex = truncString.lastIndexOf("/");
    var verString = truncString.slice(preApiIndex + 1);
    // if the current page isn't the release version, add a warning banner 
    if (verString !== "release") {
      // Create alternate "release" URL for page
      // NOTE: This won't always be a valid URL, e.g. if dev release has a brand new page
      var relURL = loc.pathname.substring(0,preApiIndex) + "/release" + loc.pathname.substring(apiIndex);
      var banner = document.createElement("div");
      banner.className = "non_release_version_warning";
      if (verString === "dev") {
        banner.innerHTML = "This document is for a version of USD that is under development. See <a href='" + relURL + "'>this page</a> for the current release.";
      } else {
        // For now, we assume any other string is an older version string
        banner.innerHTML = "This document is for an older version of USD. See <a href='" + relURL + "'>this page</a> for the current release.";
      }
      document.body.insertBefore(banner,document.body.childNodes[0]);
    }
  }
} 
</script>
</head>
<body onload="AddWarningBanner()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="USDLogoDocs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_usd_skel__intro.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">UsdSkel Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="UsdSkel_ScopeAndIntent"></a>
Overview and Purpose</h1>
<p>UsdSkel provides an encoding of simple skeletons and blend shapes, with the goal of interchanging basic skeletons and skinned models, both for game studios as well for the performant, scalable interchange of large-scale crowds. This encoding supports both interchanging skinnable rigs, as well as the interchange of skeletal control rigs on their own.</p>
<h2><a class="anchor" id="UsdSkel_Motivation"></a>
Motivation &amp; Trade-Offs</h2>
<p>UsdSkel was designed with the goal in mind of both being able to represent small numbers of characters, while also being efficient enough to be able to scale up to encoding crowds, consisting of hundreds of thousands of agents.</p>
<p>Towards this end, some expressibility trade-offs have been made in the name of scalability:</p>
<ol type="1">
<li><p class="startli">In order to enable UsdSkel to efficiently encode very large numbers of characters, joint animations are stored using a compact, vectorized encoding on each Skeleton. This avoids both excess prim and property bloat, while also greatly improving both read and write performance. Although these factors are negligible on a small number of characters, this provides <em>substantial</em> performance improvements when interchanging large numbers of characters.</p>
<p class="startli">As a consequence of this, although UsdSkel allows a sparse skeletal animation to be defined, sparse <em>layering</em> of joint transforms is not supported. Sparse animation-layering capabilities may eventually be introduced as part of an encoding of animation blending.</p>
</li>
<li>UsdSkel leverages <a href="https://openusd.org/release/glossary.html#usdglossary-instancing">scene graph instancing</a> to describe <em>rest state</em> instancing, by which the rest state of characters may be shared across multiple instances of a character, each of which has been assigned a unique animation &ndash; <em>without deinstancing</em>. This is a critical encoding feature for dealing with large numbers of characters. For the sake of enabling this feature, the encoding of a skeleton has been broken into two parts: The <a class="el" href="_usd_skel__schemas.html#UsdSkel_Skeleton">Skeleton</a> itself, and an <a class="el" href="_usd_skel__schemas.html#UsdSkel_SkelAnimation">Animation</a> associated with that skeleton.</li>
</ol>
<h2><a class="anchor" id="UsdSkel_IsNot"></a>
What UsdSkel Is Not</h2>
<p>UsdSkel does <em>not</em> signal an intent to provide general rigging and execution behaviors as core USD features. We strongly believe that such features are beyond the scope of USD's core concerns.</p>
<h1><a class="anchor" id="UsdSkel_Term"></a>
Terminology</h1>
<p>Before discussing any concepts in detail, it's important to establish some common terminology:</p>
<ul>
<li><p class="startli"><a class="anchor" id="UsdSkel_Term_Skeleton"></a><b>Skeleton</b>:</p>
<p class="startli">An encoding of an animated joint hierarchy. A Skeleton may additionally hold other properties that affect deformations, such as weights for a set of blend shapes.</p>
</li>
<li><p class="startli"><a class="anchor" id="UsdSkel_Term_SkeletonTopology"></a><b>Skeleton Topology</b>:</p>
<p class="startli">The topology is the description of the parent&lt;-&gt;child relationships of all joints in a joint hierarchy.</p>
</li>
<li><p class="startli"><b>Skel Animation</b>:</p>
<p class="startli">An encoding of animation for a <em>Skeleton's</em> joints and blendshapes.</p>
</li>
<li><p class="startli"><b>Binding</b>:</p>
<p class="startli">An encoding of the binding of a <em>Skeleton</em> to a geometry hierarchy, describing which geometric primitives the <em>Skeleton</em> deforms (if any), and how.</p>
</li>
<li><p class="startli"><a class="anchor" id="UsdSkel_Term_JointInfluences"></a><b>Joint Influences</b>:</p>
<p class="startli">The set of joint weights and indices used by skinning algorithms to describe how each point is influenced by the change in joint transformations.</p>
</li>
</ul>
<h1><a class="anchor" id="UsdSkel_SkinnablePrims"></a>
What Can Be Skinned?</h1>
<p>UsdSkel makes an attempt at encoding skinning information in a way that generalizes to many types of prims, rather than targeting a strict subset of known types.</p>
<p>As a general rule, if a primitive's type inherits from <a class="el" href="class_usd_geom_boundable.html" title="Boundable introduces the ability for a prim to persistently cache a rectilinear, local-space,...">UsdGeomBoundable</a>, and if that primitive is not itself a <em><a class="el" href="class_usd_skel_skeleton.html" title="Describes a skeleton.">UsdSkelSkeleton</a></em>, then that primitive is considered by UsdSkel to be a valid <em>candidate</em> for skinning. The utility method <a class="el" href="group___usd_skel___utils.html#ga28314cc43d8e862313fd01231d893e9e">UsdSkelIsSkinnablePrim</a> can be used to test this rule.</p>
<p>When clients iterate over the set of skinnable primitives &ndash; for example, when traversing the skinning targets of a <a class="el" href="class_usd_skel_binding.html" title="Helper object that describes the binding of a skeleton to a set of skinnable objects.">UsdSkelBinding</a> &ndash; it is the client's responsibility to check prim types to determine whether or not they know how to skin each candidate primitive.</p>
<h1><a class="anchor" id="UsdSkel_TransformSpaces"></a>
Transforms and Transform Spaces</h1>
<p>There are a few special transform spaces and transforms that will frequently be referenced:</p>
<ul>
<li><p class="startli"><b>Joint-Local Space</b>:</p>
<p class="startli">The local transform space of each joint.</p>
</li>
<li><p class="startli"><b>Skeleton Space</b>:</p>
<p class="startli">The object space of a <em>Skeleton</em>. This space does not contain the transformation that positions the root of the <em>Skeleton</em> in the world, and therefore serves as the canonical space in which to apply joint animations.</p>
<p class="startli">A <em>Skeleton</em> is transformed into world space using the world space transform of the Skeleton primitive.</p>
</li>
<li><p class="startli"><a class="anchor" id="UsdSkel_Transforms_GeomBindTransform"></a><b>Geom Bind Transform</b>:</p>
<p class="startli">The transform that positions a skinned primitive in its binding state in <em>world space</em>.</p>
</li>
<li><p class="startli"><b>Skinning Transform</b>:</p>
<p class="startli">The transform that describes a joint's change in transformation from its <em>world space</em> bind pose, to its animated, <em>skeleton space</em> pose.</p>
<p class="startli">I.e., <code>inv(jointWorldSpaceBindTransform)*jointSkelSpaceTransform</code>.</p>
</li>
</ul>
<p>For the sake of planned animation blending capabilities, UsdSkel stores all joint transforms in <em>Joint Local Space</em>.</p>
<p>To clarify the description of these spaces, a <em>Skeleton Space</em> joint transform is computed from a <em>Joint Local</em> transform as follows:</p>
<div class="fragment"><div class="line">jointSkelSpaceTransform = jointLocalSpaceTransform * parentJointSkelSpaceTransform</div></div><!-- fragment --><p>Where the <em>parentJointSkelSpaceTransform</em> is an identity matrix for root joints, or <em>jointSkelSpaceTransform</em> of the parent joint otherwise.</p>
<p>The <em>World Space</em> transform of a joint is computed as:</p>
<div class="fragment"><div class="line">jointWorldSpaceTransform = jointLocalSpaceTransform *</div><div class="line">    parentJointSkelSpaceTransform * skelLocalToWorldTransform</div></div><!-- fragment --><p>Where <em>skelLocalToWorldTransform</em> is the world space transform of the Skeleton primitive.</p>
<h1><a class="anchor" id="UsdSkel_PointSkinning"></a>
Skinning a Point (Linear Blend Skinning)</h1>
<p>Using the terminology established above, in linear blend skinning, the <em>Skeleton Space</em> position of a skinned point is computed as:</p>
<div class="fragment"><div class="line">skelSpacePoint = geomBindTransform.Transform(localSpacePoint)</div><div class="line">p = (0,0,0)</div><div class="line"><span class="keywordflow">for</span> jointIndex,jointWeight in jointInfluencesForPoint:</div><div class="line">    p += skinningTransforms[jointIndex].Transform(skelSpacePoint)*jointWeight</div></div><!-- fragment --><p>Where <em>localSpacePoint</em> is a point of a skinned primitive, given in the local space of that primitive. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="usd_skel_page_front.html">UsdSkel : USD Skeleton Schema and API</a></li>
    <li class="footer">&copy; Copyright 2023, Pixar Animation Studios. Generated on Mon Nov 20 2023 16:06:57 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>